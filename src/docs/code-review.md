# Правила ревью кода

Чеклист для Claude при проверке любого кода в этом проекте. Проходить сверху вниз, останавливаться на первом нарушении и сообщать о нём явно.

---

## 1. Типизация

- [ ] Нет `any` — нигде, ни в параметрах, ни в возвращаемых типах
- [ ] Props компонентов описаны через `interface`, не `type` (если нет union)
- [ ] Типы из внешних источников (API, формы, URL) — через Zod-схему + `z.infer<>`
- [ ] Общие типы — в `src/lib/types.ts`, модульные — в `src/modules/<name>/types.ts`
- [ ] Нет дублирования типов между модулями

## 2. Структура файлов и импорты

- [ ] Импорты в порядке: React/Next → сторонние библиотеки → `@/` → `./` → `import type`
- [ ] Только алиас `@/`, не относительные пути `../../`
- [ ] Относительные пути (`./`, `../`) — только внутри одного модуля
- [ ] Один компонент = один файл, имя файла совпадает с именем компонента (PascalCase)
- [ ] Модули не импортируют друг друга напрямую — только через `src/lib/` или props

## 3. React-компоненты

- [ ] Только функциональные компоненты
- [ ] `'use client'` стоит только там, где реально нужно (хуки, браузерные API, события)
- [ ] `'use client'` поставлен как можно глубже в дереве, не на уровне страницы/layout
- [ ] Дефолтные значения — через деструктуризацию, не через `defaultProps`
- [ ] Компонент, принимающий данные, только их отображает — без побочной логики

## 4. Server vs Client

- [ ] Нет fetch-запросов на клиенте без явной причины — данные через Server Components или Server Actions
- [ ] Server Component не импортирован внутри Client Component
- [ ] Данные из Server в Client передаются только через props и только сериализуемые значения

## 5. Server Actions

- [ ] Файл с директивой `'use server'` находится в `modules/<name>/actions.ts`
- [ ] Каждый action валидирует входные данные через Zod + `safeParse()` (не `parse()`)
- [ ] Возвращаемый тип: `{ success: true, data: T } | { success: false, error: string }`
- [ ] После мутации вызывается `revalidatePath()` или `revalidateTag()`
- [ ] Теги кэша — именованные константы, не строки на месте
- [ ] Клиентский вызов action — через `useTransition` или `useActionState`, не голый `await`

## 6. Стили

- [ ] Только Tailwind-классы, нет `style={{}}`
- [ ] Нет хардкоженых цветов: запрещены `text-[#hex]`, `bg-[#hex]`, произвольные RGB/HSL
- [ ] Все цвета — через CSS-переменные или токены дизайн-системы
- [ ] Адаптивность — mobile-first: `sm:`, `md:`, `lg:`

## 7. Состояние

- [ ] Серверные данные не дублируются в `useState`
- [ ] Фильтры/поиск/пагинация — в URL (`useSearchParams`), не в локальном стейте
- [ ] Нет глобального стейт-менеджера без явного согласования

## 8. Именование

- [ ] Компонент — PascalCase
- [ ] Хук — camelCase с префиксом `use`
- [ ] Утилита/хелпер — camelCase
- [ ] Константа — UPPER_SNAKE_CASE
- [ ] Тип/Интерфейс — PascalCase
- [ ] Имена по смыслу, не по типу (`userList`, не `array`)

## 9. Качество кода

- [ ] Нет `console.log` (кроме явно временной отладки)
- [ ] Нет дублирования логики — если встречается дважды, выносить
- [ ] Нет кода "на будущее" — только то, что нужно прямо сейчас
- [ ] Нет `TODO`, `FIXME`, `HACK` без обсуждения
- [ ] Комментарии только там, где логика неочевидна

## 10. Безопасность

- [ ] Нет секретов, токенов, ключей в коде или git
- [ ] Пользовательский ввод валидируется на границе системы (Server Action)
- [ ] Публичные ключи (`NEXT_PUBLIC_*`) — только в `src/config/`, не разбросаны по компонентам

## 11. Документация модуля

- [ ] После изменения модуля обновлён `src/docs/<module-name>.md`
- [ ] Документация сухая: только факты, никаких примеров кода

---

## Красные флаги — стоп, сообщить сразу

- `any` в типах
- Хардкоженый цвет (HEX/RGB/HSL)
- Server Component внутри Client Component
- Секрет или токен в коде
- Дублирование типа, который уже есть в `src/lib/types.ts`
- Относительный путь `../../` вместо `@/`
- Вызов Server Action без `useTransition` / `useActionState`
- `process.env` напрямую внутри компонента (не через `@/config/`)
